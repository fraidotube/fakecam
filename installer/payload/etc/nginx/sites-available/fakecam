server {
  listen 80 default_server;
  server_name _;
  root /var/www/html;
  index index.html;

  auth_basic "Restricted";
  auth_basic_user_file /etc/nginx/.htpasswd;

  set $nocache 'no-cache, no-store, must-revalidate';

  location = / {
    add_header Cache-Control $nocache always;
    add_header Pragma 'no-cache' always;
    add_header Expires '0' always;
    try_files $uri /index.html;
  }

  location /hls/ {
    add_header Cache-Control $nocache always;
    add_header Pragma 'no-cache' always;
    add_header Expires '0' always;
    proxy_pass http://127.0.0.1:8888/;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
  }

  location /netui/ {
    add_header Cache-Control $nocache always;
    add_header Pragma 'no-cache' always;
    add_header Expires '0' always;
    proxy_pass http://127.0.0.1:5001/;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
  }

  location = /netui/change-password {
    auth_basic off;
    add_header Cache-Control $nocache always;
    add_header Pragma 'no-cache' always;
    add_header Expires '0' always;
    proxy_pass http://127.0.0.1:5001/change-password;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
  }

  location = /logout {
    auth_basic off;
    add_header Cache-Control $nocache always;
    add_header Pragma 'no-cache' always;
    add_header Expires '0' always;
    add_header WWW-Authenticate 'Basic realm="Logged out"' always;
    return 401;
  }
}
